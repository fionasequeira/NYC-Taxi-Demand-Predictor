{"paragraphs":[{"text":"%pyspark\nfrom pyspark.sql import SQLContext\nfrom pyspark.sql.functions import *\nimport datetime\ncab = sqlContext.read.load('/shared/g/FinalDatasets/CabDataWithLatLong.csv', \n                          format='com.databricks.spark.csv', \n                          header='true', \n                          inferSchema='true')\n\nevent = sqlContext.read.load('/shared/g/FinalDatasets/Events.csv', \n                          format='com.databricks.spark.csv', \n                          header='true', \n                          inferSchema='true')\nevent=event.drop(event[0])\nevent=event.drop(event[0])\ncab=cab.drop(cab[0])\n#event1 = event.select(year(event[0]).alias('min'), event[0].).show(5)\n\nevent=event.select(event[0], event[1], event[2], event[3], event[4], event[5].alias('latitude_e'), event[6].alias('longitude_e'), event[7], event[8], event[9], event[10], event[11], event[12], event[13], event[14], event[15].alias('LocationID'), hour(event[0]).alias('Hour'), month(event[0]).alias('Month'), dayofmonth(event[0]).alias('DayofMonth'), date_format(event[0], 'u').alias('Weekday_e'))\nevent=event.select(event[0], event[1], event[2], event[3], event[4], event[5], event[6], event[7], event[8], event[9], event[10], event[11], event[12], event[13], event[14], event[15].cast('integer'), event[16], event[17], event[18], event[19])","user":"anonymous","dateUpdated":"2017-12-06T01:53:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512504839936_-1810807544","id":"20171205-201359_1366869678","dateCreated":"2017-12-05T20:13:59+0000","dateStarted":"2017-12-06T01:53:37+0000","dateFinished":"2017-12-06T01:54:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3392"},{"text":"%pyspark\ncab=cab.drop(cab[0])\ncab.dtypes","user":"anonymous","dateUpdated":"2017-12-06T01:54:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('Month', 'int'), ('DayofMonth', 'int'), ('Hour', 'int'), ('LocationID', 'int'), ('TaxiCount', 'int'), ('latitude', 'double'), ('longitude', 'double'), ('Weekday', 'int')]\n"}]},"apps":[],"jobName":"paragraph_1512504883599_1821668118","id":"20171205-201443_481724334","dateCreated":"2017-12-05T20:14:43+0000","dateStarted":"2017-12-06T01:54:48+0000","dateFinished":"2017-12-06T01:54:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3393"},{"text":"%pyspark\nevent.dtypes","user":"anonymous","dateUpdated":"2017-12-06T01:55:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('datetime_local', 'timestamp'), ('popularity', 'double'), ('score', 'double'), ('short_title', 'string'), ('Venue_id', 'string'), ('latitude_e', 'double'), ('longitude_e', 'double'), ('Venue_name', 'string'), ('average_price', 'string'), ('highest_price', 'double'), ('listing_count', 'int'), ('lowest_price', 'int'), ('lowest_price_good_deals', 'int'), ('type', 'string'), ('type2', 'string'), ('LocationID', 'int'), ('Hour', 'int'), ('Month', 'int'), ('DayofMonth', 'int'), ('Weekday_e', 'string')]\n"}]},"apps":[],"jobName":"paragraph_1512505077912_-722182696","id":"20171205-201757_430422381","dateCreated":"2017-12-05T20:17:57+0000","dateStarted":"2017-12-06T01:55:06+0000","dateFinished":"2017-12-06T01:55:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3394"},{"text":"%pyspark\nevent.count()","user":"anonymous","dateUpdated":"2017-12-06T01:55:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"12606\n"}]},"apps":[],"jobName":"paragraph_1512505106305_2033586497","id":"20171205-201826_506010435","dateCreated":"2017-12-05T20:18:26+0000","dateStarted":"2017-12-06T01:55:09+0000","dateFinished":"2017-12-06T01:55:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3395"},{"text":"%pyspark\r\nfrom pyspark.sql import SQLContext\r\n#cab = sqlContext.inferSchema(cab_table)\r\ncab.createOrReplaceTempView(\"cab_table\")","user":"anonymous","dateUpdated":"2017-12-06T01:55:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512505123111_-667320134","id":"20171205-201843_1669054472","dateCreated":"2017-12-05T20:18:43+0000","dateStarted":"2017-12-06T01:55:39+0000","dateFinished":"2017-12-06T01:55:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3396"},{"text":"%pyspark\nsqlContext.sql('select * from cab_table').show(5)","user":"anonymous","dateUpdated":"2017-12-06T01:55:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+----------+----+----------+---------+------------------+------------------+-------+\n|Month|DayofMonth|Hour|LocationID|TaxiCount|          latitude|         longitude|Weekday|\n+-----+----------+----+----------+---------+------------------+------------------+-------+\n|    7|         1|   0|         7|      104|40.772014500000004|       -73.9302672|      5|\n|    7|         1|   0|        17|       54|        40.7202445|        -73.955425|      5|\n|    7|         1|   0|        18|        1|        40.8700999|       -73.8856911|      5|\n|    7|         1|   0|        20|        3|40.855277799999996|-73.88638879999999|      5|\n|    7|         1|   0|        24|        6|        40.7958865|        -73.967511|      5|\n+-----+----------+----+----------+---------+------------------+------------------+-------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1512505159490_-1313066706","id":"20171205-201919_369439925","dateCreated":"2017-12-05T20:19:19+0000","dateStarted":"2017-12-06T01:55:43+0000","dateFinished":"2017-12-06T01:55:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3397"},{"text":"%pyspark\nfrom pyspark.sql import SQLContext\n#cab = sqlContext.inferSchema(cab_table)\nevent.createOrReplaceTempView(\"event_table\")","user":"anonymous","dateUpdated":"2017-12-06T01:55:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512505434385_-1269591724","id":"20171205-202354_1870517072","dateCreated":"2017-12-05T20:23:54+0000","dateStarted":"2017-12-06T01:55:47+0000","dateFinished":"2017-12-06T01:55:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3398"},{"text":"%pyspark\nsqlContext.sql('select * from event_table').show(5)","user":"anonymous","dateUpdated":"2017-12-06T01:55:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----------+--------+--------------------+--------+----------+-----------+--------------------+-------------+-------------+-------------+------------+-----------------------+--------------------+-----+----------+----+-----+----------+---------+\n|      datetime_local|popularity|   score|         short_title|Venue_id|latitude_e|longitude_e|          Venue_name|average_price|highest_price|listing_count|lowest_price|lowest_price_good_deals|                type|type2|LocationID|Hour|Month|DayofMonth|Weekday_e|\n+--------------------+----------+--------+--------------------+--------+----------+-----------+--------------------+-------------+-------------+-------------+------------+-----------------------+--------------------+-----+----------+----+-----+----------+---------+\n|2017-07-05 14:00:...|  0.701158|0.696581| Hamilton - New York|    2935|   40.7592|   -73.9866|Richard Rodgers T...|       1761.0|       5896.0|           83|         302|                    302|broadway_tickets_...|    1|       230|  14|    7|         5|        3|\n|2017-07-05 14:00:...|  0.632637|0.605959| Waitress - New York|    2925|   40.7602|   -73.9868|Brooks Atkinson T...|        354.0|       1032.0|           89|         214|                    214|broadway_tickets_...|    1|       230|  14|    7|         5|        3|\n|2017-07-05 14:00:...|       0.0|0.487658| Pipeline - New York|    2952|   40.7736|    -73.984|Lincoln Center Th...|        304.0|        633.0|           16|         214|                    214|broadway_tickets_...|    1|       163|  14|    7|         5|        3|\n|2017-07-05 14:00:...|  0.684254|0.612875|War Paint - New York|    2948|   40.7557|   -73.9882| Nederlander Theatre|        380.0|        656.0|           66|         136|                    136|broadway_tickets_...|    1|       100|  14|    7|         5|        3|\n|2017-07-05 14:00:...|  0.677828|0.449373|The Great Comet -...|    2302|   40.7588|   -73.9873|    Imperial Theatre|        536.5|        636.0|            6|         437|                    437|broadway_tickets_...|    1|       100|  14|    7|         5|        3|\n+--------------------+----------+--------+--------------------+--------+----------+-----------+--------------------+-------------+-------------+-------------+------------+-----------------------+--------------------+-----+----------+----+-----+----------+---------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1512505454082_1109726122","id":"20171205-202414_1594802765","dateCreated":"2017-12-05T20:24:14+0000","dateStarted":"2017-12-06T01:55:49+0000","dateFinished":"2017-12-06T01:55:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3399"},{"text":"%pyspark\n\nevent_cab=sqlContext.sql('select e.datetime_local, e.short_title, e.popularity, e.score, e.Venue_id, e.latitude_e, e.longitude_e, e.Venue_name, e.average_price, e.highest_price, e.listing_count, e.lowest_price, e.lowest_price_good_deals, e.type, e.type2, e.Hour, e.Month, e.DayofMonth, e.Weekday_e, c.TaxiCount, c.LocationID, c.latitude, c.longitude, c.Weekday from event_table e inner join cab_table c on e.LocationID=c.LocationID and e.Month=c.Month and e.DayofMonth=c.DayofMonth and e.Hour=c.Hour')","user":"anonymous","dateUpdated":"2017-12-06T02:02:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512505479735_308525670","id":"20171205-202439_1698308245","dateCreated":"2017-12-05T20:24:39+0000","dateStarted":"2017-12-06T02:02:49+0000","dateFinished":"2017-12-06T02:02:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3400"},{"text":"%pyspark\nevent_cab.count()","user":"anonymous","dateUpdated":"2017-12-06T02:02:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"981\n"}]},"apps":[],"jobName":"paragraph_1512505724090_414852640","id":"20171205-202844_1912806904","dateCreated":"2017-12-05T20:28:44+0000","dateStarted":"2017-12-06T02:02:54+0000","dateFinished":"2017-12-06T02:02:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3401"},{"text":"%pyspark\nweather = sqlContext.read.load('/shared/g/FinalDatasets/Weather_updated.csv', \n                          format='com.databricks.spark.csv', \n                          header='true', \n                          inferSchema='true')\nweather=weather.drop(weather[0])\nweather=weather.dropDuplicates()\nweather=weather.select(weather[0], weather[1], weather[2], weather[3], weather[4], weather[5], weather[6].alias('Month'), weather[7].alias('DayofMonth'), weather[8].alias('Hour'), weather[9])\nweather.show(5)","user":"anonymous","dateUpdated":"2017-12-06T02:03:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+---------+--------+--------+----------------+-----------+-----+----------+----+---------------+\n|Day_Date| Day_Name|   Hour3|Temp_Avg|      Conditions|Conditions2|Month|DayofMonth|Hour|      timestamp|\n+--------+---------+--------+--------+----------------+-----------+-----+----------+----+---------------+\n|  19-Aug| Saturday| 2:00 PM|    84.9|   Mostly Cloudy|          4|    8|        19|  14|8/19/2017 14:00|\n|   9-Jul|   Sunday| 3:00 AM|    72.0|Scattered Clouds|          0|    7|         9|   3|  7/9/2017 3:00|\n|  24-Jul|   Monday| 7:00 PM|    66.9|   Mostly Cloudy|          4|    7|        24|  19|7/24/2017 19:00|\n|   1-Nov|Wednesday|12:00 AM|    44.1|   Mostly Cloudy|          4|   11|         1|   0| 11/1/2017 0:00|\n|   7-Nov|  Tuesday| 4:00 AM|    43.0|           Clear|          0|   11|         7|   4| 11/7/2017 4:00|\n+--------+---------+--------+--------+----------------+-----------+-----+----------+----+---------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1512505756936_-362862805","id":"20171205-202916_972271073","dateCreated":"2017-12-05T20:29:16+0000","dateStarted":"2017-12-06T02:03:14+0000","dateFinished":"2017-12-06T02:03:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3402"},{"text":"%pyspark\n#weather=weather.dropDuplicates()\n#weather.count()\nweather.dtypes","user":"anonymous","dateUpdated":"2017-12-06T02:03:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('Day_Date', 'string'), ('Day_Name', 'string'), ('Hour3', 'string'), ('Temp_Avg', 'double'), ('Conditions', 'string'), ('Conditions2', 'int'), ('Month', 'int'), ('DayofMonth', 'int'), ('Hour', 'int'), ('timestamp', 'string')]\n"}]},"apps":[],"jobName":"paragraph_1512505865107_1546615338","id":"20171205-203105_1952189843","dateCreated":"2017-12-05T20:31:05+0000","dateStarted":"2017-12-06T02:03:21+0000","dateFinished":"2017-12-06T02:03:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3403"},{"text":"%pyspark\nfrom pyspark.sql import SQLContext\n#cab = sqlContext.inferSchema(cab_table)\nweather.createOrReplaceTempView(\"weather_table\")","user":"anonymous","dateUpdated":"2017-12-06T02:03:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512505875524_-1583362413","id":"20171205-203115_1678798724","dateCreated":"2017-12-05T20:31:15+0000","dateStarted":"2017-12-06T02:03:27+0000","dateFinished":"2017-12-06T02:03:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3404"},{"text":"%pyspark\nevent_cab.createOrReplaceTempView(\"event_cab_table\")","user":"anonymous","dateUpdated":"2017-12-06T02:03:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512505920730_-541001022","id":"20171205-203200_851363505","dateCreated":"2017-12-05T20:32:00+0000","dateStarted":"2017-12-06T02:03:30+0000","dateFinished":"2017-12-06T02:03:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3405"},{"text":"%pyspark\nsqlContext.sql('select * from event_cab_table').show(5)\n#event_cab_weather=sqlContext.sql('select * from event_cab_table ec inner join weather_table w on ec.Month=w.Month and ec.DayofMonth=w.DayofMonth and ec.Hour=w.Hour')","user":"anonymous","dateUpdated":"2017-12-06T02:03:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+------------------+------------------+--------+----------+-----------+-----------------+-------------+-------------+-------------+------------+-----------------------+--------------------+-----+----+-----+----------+---------+---------+----------+------------------+------------------+-------+\n|      datetime_local|         short_title|        popularity|             score|Venue_id|latitude_e|longitude_e|       Venue_name|average_price|highest_price|listing_count|lowest_price|lowest_price_good_deals|                type|type2|Hour|Month|DayofMonth|Weekday_e|TaxiCount|LocationID|          latitude|         longitude|Weekday|\n+--------------------+--------------------+------------------+------------------+--------+----------+-----------+-----------------+-------------+-------------+-------------+------------+-----------------------+--------------------+-----+----+-----+----------+---------+---------+----------+------------------+------------------+-------+\n|2017-07-05 14:00:...|Hello, Dolly! - N...|          0.692593|          0.588942|    3187|   40.6971|   -73.9796|  Shubert Theatre|       1007.0|       1884.0|           35|         410|                    410|broadway_tickets_...|    1|  14|    7|         5|        3|       33|        65|40.693925799999995|-73.98543640000001|      2|\n|2017-07-05 14:00:...|Dear Evan Hansen ...|               0.0|          0.604179|    3298|   40.6971|   -73.9796|Music Box Theatre|        759.0|       1126.0|           12|         476|                      0|broadway_tickets_...|    1|  14|    7|         5|        3|       33|        65|40.693925799999995|-73.98543640000001|      2|\n|2017-07-05 19:30:...|Amateur Night At ...|0.5800960000000001|0.4633060000000001|    1817|   40.8097|   -73.9502|   Apollo Theater|         60.0|         63.0|            5|          57|                     57|             theater|    3|  19|    7|         5|        3|       10|       152|        40.8169444|       -73.9558332|      2|\n|2017-07-05 20:30:...|     Kevin Greenspon|               0.0|               0.0|   69479|   40.6971|   -73.9061|      Trans-Pecos|          0.0|          0.0|            0|           0|                      0|             concert|    2|  20|    7|         5|        3|        1|        36|        40.6942696|-73.91874809999999|      2|\n|2017-07-05 20:00:...|Dear Evan Hansen ...|               0.0|          0.601474|    3298|   40.6971|   -73.9796|Music Box Theatre|        668.0|        825.0|           42|         396|                      0|broadway_tickets_...|    1|  20|    7|         5|        3|       27|        65|40.693925799999995|-73.98543640000001|      2|\n+--------------------+--------------------+------------------+------------------+--------+----------+-----------+-----------------+-------------+-------------+-------------+------------+-----------------------+--------------------+-----+----+-----+----------+---------+---------+----------+------------------+------------------+-------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1512506057794_-1347988031","id":"20171205-203417_604091257","dateCreated":"2017-12-05T20:34:17+0000","dateStarted":"2017-12-06T02:03:33+0000","dateFinished":"2017-12-06T02:03:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3406"},{"text":"%pyspark\nevent_cab.dtypes","user":"anonymous","dateUpdated":"2017-12-06T02:03:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('datetime_local', 'timestamp'), ('short_title', 'string'), ('popularity', 'double'), ('score', 'double'), ('Venue_id', 'string'), ('latitude_e', 'double'), ('longitude_e', 'double'), ('Venue_name', 'string'), ('average_price', 'string'), ('highest_price', 'double'), ('listing_count', 'int'), ('lowest_price', 'int'), ('lowest_price_good_deals', 'int'), ('type', 'string'), ('type2', 'string'), ('Hour', 'int'), ('Month', 'int'), ('DayofMonth', 'int'), ('Weekday_e', 'string'), ('TaxiCount', 'int'), ('LocationID', 'int'), ('latitude', 'double'), ('longitude', 'double'), ('Weekday', 'int')]\n"}]},"apps":[],"jobName":"paragraph_1512506101958_980389719","id":"20171205-203501_1589468812","dateCreated":"2017-12-05T20:35:01+0000","dateStarted":"2017-12-06T02:03:39+0000","dateFinished":"2017-12-06T02:03:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3407"},{"text":"%pyspark\n\nevent_cab_weather=sqlContext.sql('select e.datetime_local, e.short_title, e.popularity, e.score, e.Venue_id, e.latitude_e, e.longitude_e, e.Venue_name, e.average_price, e.highest_price, e.listing_count, e.lowest_price, e.lowest_price_good_deals, e.type, e.type2, e.Weekday_e, e.TaxiCount, e.LocationID, e.latitude, e.longitude, e.Weekday, w.Month, w.DayofMonth, e.Hour, w.Temp_Avg, w.Conditions, w.Conditions2, w.timestamp from event_cab_table e inner join weather_table w on e.Month=w.Month and e.DayofMonth=w.DayofMonth and e.Hour=w.Hour')","user":"anonymous","dateUpdated":"2017-12-06T02:08:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512507196727_387433656","id":"20171205-205316_1526625545","dateCreated":"2017-12-05T20:53:16+0000","dateStarted":"2017-12-06T02:08:03+0000","dateFinished":"2017-12-06T02:08:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3408"},{"text":"%pyspark\nevent_cab_weather.count()","user":"anonymous","dateUpdated":"2017-12-06T02:08:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"981\n"}]},"apps":[],"jobName":"paragraph_1512507618287_-1875075411","id":"20171205-210018_49878130","dateCreated":"2017-12-05T21:00:18+0000","dateStarted":"2017-12-06T02:08:11+0000","dateFinished":"2017-12-06T02:08:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3409"},{"text":"%pyspark\nfrom pyspark.sql import SQLContext\ntaxiAug = spark.read.json('/shared/g/FinalDatasets/TaxiCountAug2016YG.json')","user":"anonymous","dateUpdated":"2017-12-06T00:55:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512507627193_-1192900287","id":"20171205-210027_844348741","dateCreated":"2017-12-05T21:00:27+0000","dateStarted":"2017-12-06T00:55:25+0000","dateFinished":"2017-12-06T00:55:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3410"},{"text":"%pyspark\ntaxiAug.dropDuplicates()","user":"anonymous","dateUpdated":"2017-12-06T00:56:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[_corrupt_record: string, _id: struct<dayOfMonth:bigint,hour:bigint,location:bigint,month:bigint>, count: bigint]\n"}]},"apps":[],"jobName":"paragraph_1512521516732_-1159292881","id":"20171206-005156_491353434","dateCreated":"2017-12-06T00:51:56+0000","dateStarted":"2017-12-06T00:56:37+0000","dateFinished":"2017-12-06T00:56:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3411"},{"text":"%pyspark\ntaxiAug.count()","user":"anonymous","dateUpdated":"2017-12-06T00:56:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"67769\n"}]},"apps":[],"jobName":"paragraph_1512521740175_-44171787","id":"20171206-005540_678118779","dateCreated":"2017-12-06T00:55:40+0000","dateStarted":"2017-12-06T00:56:48+0000","dateFinished":"2017-12-06T00:56:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3412"},{"text":"%pyspark\nevent_cab_weather.write.csv(\"/shared/g/FinalData.csv\", header=True)","user":"anonymous","dateUpdated":"2017-12-06T02:09:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512521807945_1396236149","id":"20171206-005647_415082072","dateCreated":"2017-12-06T00:56:47+0000","dateStarted":"2017-12-06T02:09:04+0000","dateFinished":"2017-12-06T02:09:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3413"},{"text":"%pyspark\nevent_cab_g = sqlContext.read.load('/shared/g/Events_subset.csv', \n                          format='com.databricks.spark.csv', \n                          header='true', \n                          inferSchema='true')\n\nevent_cab_g=event_cab_g.drop(event_cab_g[0])\nevent_cab_g=event_cab_g.drop(event_cab_g[0])","user":"anonymous","dateUpdated":"2017-12-07T21:56:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512523667320_-1821380628","id":"20171206-012747_238077814","dateCreated":"2017-12-06T01:27:47+0000","dateStarted":"2017-12-07T21:56:23+0000","dateFinished":"2017-12-07T21:56:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3414"},{"text":"%pyspark\nevent_cab_g.dtypes","user":"anonymous","dateUpdated":"2017-12-07T21:56:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('datetime_local', 'timestamp'), ('popularity', 'double'), ('score', 'double'), ('short_title', 'string'), ('Venue_id', 'int'), ('latitude', 'double'), ('longitude', 'double'), ('Venue_name', 'string'), ('average_price', 'double'), ('highest_price', 'int'), ('listing_count', 'int'), ('lowest_price', 'int'), ('lowest_price_good_deals', 'int'), ('type', 'string'), ('type2', 'int'), ('Location ID', 'int'), ('cab count', 'string')]\n"}]},"apps":[],"jobName":"paragraph_1512677067649_914954548","id":"20171207-200427_693336537","dateCreated":"2017-12-07T20:04:27+0000","dateStarted":"2017-12-07T21:56:30+0000","dateFinished":"2017-12-07T21:56:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3415"},{"text":"%pyspark\nevent_cab_g.count()","user":"anonymous","dateUpdated":"2017-12-07T21:56:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"838\n"}]},"apps":[],"jobName":"paragraph_1512679858697_1008079629","id":"20171207-205058_1970456955","dateCreated":"2017-12-07T20:50:58+0000","dateStarted":"2017-12-07T21:56:37+0000","dateFinished":"2017-12-07T21:56:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3416"},{"text":"%pyspark\nweather = sqlContext.read.load('/shared/g/FinalDatasets/Weather_updated.csv', \n                          format='com.databricks.spark.csv', \n                          header='true', \n                          inferSchema='true')\nweather=weather.drop(weather[0])\nweather=weather.dropDuplicates()\nweather=weather.select(weather[0], weather[1], weather[2], weather[3], weather[4], weather[5], weather[6].alias('Month'), weather[7].alias('DayofMonth'), weather[8].alias('Hour'), weather[9])\nweather.show(5)","user":"anonymous","dateUpdated":"2017-12-07T20:55:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+---------+--------+--------+----------------+-----------+-----+----------+----+---------------+\n|Day_Date| Day_Name|   Hour3|Temp_Avg|      Conditions|Conditions2|Month|DayofMonth|Hour|      timestamp|\n+--------+---------+--------+--------+----------------+-----------+-----+----------+----+---------------+\n|  19-Aug| Saturday| 2:00 PM|    84.9|   Mostly Cloudy|          4|    8|        19|  14|8/19/2017 14:00|\n|   9-Jul|   Sunday| 3:00 AM|    72.0|Scattered Clouds|          0|    7|         9|   3|  7/9/2017 3:00|\n|  24-Jul|   Monday| 7:00 PM|    66.9|   Mostly Cloudy|          4|    7|        24|  19|7/24/2017 19:00|\n|   1-Nov|Wednesday|12:00 AM|    44.1|   Mostly Cloudy|          4|   11|         1|   0| 11/1/2017 0:00|\n|   7-Nov|  Tuesday| 4:00 AM|    43.0|           Clear|          0|   11|         7|   4| 11/7/2017 4:00|\n+--------+---------+--------+--------+----------------+-----------+-----+----------+----+---------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1512679899591_1641253725","id":"20171207-205139_628805643","dateCreated":"2017-12-07T20:51:39+0000","dateStarted":"2017-12-07T20:55:55+0000","dateFinished":"2017-12-07T20:56:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3417"},{"text":"%pyspark\nimport datetime\nfrom pyspark.sql.functions import *\nevent_cab_g=event_cab_g.select(event_cab_g[0], event_cab_g[1], event_cab_g[2], event_cab_g[3], event_cab_g[4], event_cab_g[5], event_cab_g[6], event_cab_g[7], event_cab_g[8], event_cab_g[9], event_cab_g[10], event_cab_g[11], event_cab_g[12], event_cab_g[13], event_cab_g[14], event_cab_g[15].alias('LocationID'),event_cab_g[16].alias('cab_count'), hour(event_cab_g[0]).alias('Hour'),month(event_cab_g[0]).alias('Month'), dayofmonth(event_cab_g[0]).alias('DayofMonth'))","user":"anonymous","dateUpdated":"2017-12-07T21:56:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512680154956_-1643977047","id":"20171207-205554_1636772828","dateCreated":"2017-12-07T20:55:54+0000","dateStarted":"2017-12-07T21:56:58+0000","dateFinished":"2017-12-07T21:56:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3418"},{"text":"%pyspark\nevent_cab_g.dtypes","user":"anonymous","dateUpdated":"2017-12-07T21:57:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('datetime_local', 'timestamp'), ('popularity', 'double'), ('score', 'double'), ('short_title', 'string'), ('Venue_id', 'int'), ('latitude', 'double'), ('longitude', 'double'), ('Venue_name', 'string'), ('average_price', 'double'), ('highest_price', 'int'), ('listing_count', 'int'), ('lowest_price', 'int'), ('lowest_price_good_deals', 'int'), ('type', 'string'), ('type2', 'int'), ('LocationID', 'int'), ('cab_count', 'string'), ('Hour', 'int'), ('Month', 'int'), ('DayofMonth', 'int')]\n"}]},"apps":[],"jobName":"paragraph_1512680573597_-92504205","id":"20171207-210253_760284264","dateCreated":"2017-12-07T21:02:53+0000","dateStarted":"2017-12-07T21:57:04+0000","dateFinished":"2017-12-07T21:57:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3419"},{"text":"%pyspark\nevent_cab_g.count()","user":"anonymous","dateUpdated":"2017-12-07T21:57:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"838\n"}]},"apps":[],"jobName":"paragraph_1512680585664_-1398726721","id":"20171207-210305_1002549155","dateCreated":"2017-12-07T21:03:05+0000","dateStarted":"2017-12-07T21:57:22+0000","dateFinished":"2017-12-07T21:57:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3420"},{"text":"%pyspark\nfrom pyspark.sql import SQLContext\n#cab = sqlContext.inferSchema(cab_table)\n#weather.createOrReplaceTempView(\"weather_table\")\nevent_cab_g.createOrReplaceTempView(\"event_cab_g_table\")","user":"anonymous","dateUpdated":"2017-12-07T21:57:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512680611683_268637095","id":"20171207-210331_272464134","dateCreated":"2017-12-07T21:03:31+0000","dateStarted":"2017-12-07T21:57:33+0000","dateFinished":"2017-12-07T21:57:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3421"},{"text":"%pyspark\n\nevent_cab_weather_g=sqlContext.sql('select e.datetime_local, e.short_title, e.popularity, e.score, e.Venue_id, e.latitude, e.longitude, e.Venue_name, e.average_price, e.highest_price, e.listing_count, e.lowest_price, e.lowest_price_good_deals, e.type, e.type2, e.cab_count, e.LocationID, w.Month, w.DayofMonth, e.Hour, w.Temp_Avg, w.Conditions, w.Conditions2, w.timestamp from event_cab_g_table e inner join weather_table w on e.Month=w.Month and e.DayofMonth=w.DayofMonth and e.Hour=w.Hour')","user":"anonymous","dateUpdated":"2017-12-07T21:58:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512680693727_2063044668","id":"20171207-210453_339728561","dateCreated":"2017-12-07T21:04:53+0000","dateStarted":"2017-12-07T21:58:12+0000","dateFinished":"2017-12-07T21:58:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3422"},{"text":"%pyspark\nevent_cab_weather_g.count()","user":"anonymous","dateUpdated":"2017-12-07T21:58:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"838\n"}]},"apps":[],"jobName":"paragraph_1512680916125_1763647083","id":"20171207-210836_1524083636","dateCreated":"2017-12-07T21:08:36+0000","dateStarted":"2017-12-07T21:58:18+0000","dateFinished":"2017-12-07T21:58:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3423"},{"text":"%pyspark\nevent_cab_weather_g.write.csv(\"/shared/g/event_cab_weather_g.csv\", header=True)","user":"anonymous","dateUpdated":"2017-12-07T21:59:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512681122877_1535763008","id":"20171207-211202_363275999","dateCreated":"2017-12-07T21:12:02+0000","dateStarted":"2017-12-07T21:59:13+0000","dateFinished":"2017-12-07T21:59:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3424"},{"text":"%pyspark\neventcab_weather_g = sqlContext.read.load('/shared/g/eventcab_weather_g.csv', \n                          format='com.databricks.spark.csv', \n                          header='true', \n                          inferSchema='true')","user":"anonymous","dateUpdated":"2017-12-08T00:04:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512683953559_-675575577","id":"20171207-215913_902798962","dateCreated":"2017-12-07T21:59:13+0000","dateStarted":"2017-12-08T00:04:29+0000","dateFinished":"2017-12-08T00:04:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3425"},{"text":"%pyspark\neventcab_weather_g.dtypes","user":"anonymous","dateUpdated":"2017-12-08T00:04:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('datetime_local', 'timestamp'), ('short_title', 'string'), ('popularity', 'double'), ('score', 'double'), ('Venue_id', 'int'), ('latitude', 'double'), ('longitude', 'double'), ('Venue_name', 'string'), ('average_price', 'double'), ('highest_price', 'int'), ('listing_count', 'int'), ('lowest_price', 'int'), ('lowest_price_good_deals', 'int'), ('type', 'string'), ('type2', 'int'), ('TaxiCount', 'int'), ('LocationID', 'int'), ('Month', 'int'), ('DayofMonth', 'int'), ('Hour', 'int'), ('Temp_Avg', 'double'), ('Conditions', 'string'), ('Conditions2', 'int'), ('timestamp', 'string')]\n"}]},"apps":[],"jobName":"paragraph_1512691469274_-213647337","id":"20171208-000429_282488658","dateCreated":"2017-12-08T00:04:29+0000","dateStarted":"2017-12-08T00:04:40+0000","dateFinished":"2017-12-08T00:04:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3426"},{"text":"%pyspark\neventcab_weather_g.count()","user":"anonymous","dateUpdated":"2017-12-08T00:05:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1819\n"}]},"apps":[],"jobName":"paragraph_1512691480343_1299970160","id":"20171208-000440_1502007841","dateCreated":"2017-12-08T00:04:40+0000","dateStarted":"2017-12-08T00:05:06+0000","dateFinished":"2017-12-08T00:05:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3427"},{"text":"%pyspark\neventcab_weather_g.dropDuplicates()","user":"anonymous","dateUpdated":"2017-12-08T00:04:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[datetime_local: timestamp, short_title: string, popularity: double, score: double, Venue_id: int, latitude: double, longitude: double, Venue_name: string, average_price: double, highest_price: int, listing_count: int, lowest_price: int, lowest_price_good_deals: int, type: string, type2: int, TaxiCount: int, LocationID: int, Month: int, DayofMonth: int, Hour: int, Temp_Avg: double, Conditions: string, Conditions2: int, timestamp: string]\n"}]},"apps":[],"jobName":"paragraph_1512691487873_-1709535736","id":"20171208-000447_1738431196","dateCreated":"2017-12-08T00:04:47+0000","dateStarted":"2017-12-08T00:04:56+0000","dateFinished":"2017-12-08T00:04:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3428"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2017-12-08T00:04:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1512691496386_-491405394","id":"20171208-000456_637797018","dateCreated":"2017-12-08T00:04:56+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3429"}],"name":"join","id":"2D1CN5T71","angularObjects":{"2CZQQU2NT:shared_process":[],"2D36CT3E1:shared_process":[],"2CYNP9MYY:shared_process":[],"2D2YYS7J4:shared_process":[],"2D1ECXREX:shared_process":[],"2D2X352NT:shared_process":[],"2D2VHETU2:shared_process":[],"2CYYFYJEE:shared_process":[],"2D2P5UGN2:shared_process":[],"2D1Q9S1W3:shared_process":[],"2CZBWV7BB:shared_process":[],"2D22B9YUQ:shared_process":[],"2CZDHSNKY:shared_process":[],"2D27BWN65:shared_process":[],"2D1W13ECA:shared_process":[],"2D2BDX714:shared_process":[],"2D1CACHNY:shared_process":[],"2D2SP7Q7F:shared_process":[],"2D2GN97UQ:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}